---
title: "`logback-spring.xml` の中では `:-` でなく `:` を使用しましょう。"
date: 2020-01-28T07:28:12Z
draft: false
tags:
  - spring-boot
  - logback
---

== 要旨

`logback-spring.xml` の中では `:-` でなく `:` を使用しましょう。

== 解説

Spring Bootのリファレンスに次のような記述があります:

[quote, 'https://docs.spring.io/spring-boot/docs/2.2.4.RELEASE/reference/html/spring-boot-features.html#boot-features-custom-log-configuration[4.6. Custom Log Configuration]']
____
If you want to use a placeholder in a logging property, you should use https://docs.spring.io/spring-boot/docs/2.2.4.RELEASE/reference/html/spring-boot-features.html#boot-features-external-config-placeholders-in-properties[Spring Boot’s syntax] and not the syntax of the underlying framework. Notably, if you use Logback, you should use `:` as the delimiter between a property name and its default value and not use `:-`.
____

にもかかわらず、結構 `logback-spring.xml` の中で `:-` を使用しているサンプルが検索すると見つかります。

この点が少し気になったので調べてみました。

Gitリポジトリで履歴をたどったところ、次のissueで追加された文章でした:

- https://github.com/spring-projects/spring-boot/issues/4731[Is DefaultLogbackConfiguration correct with ${LOG_LEVEL_PATTERN:-%5p} #4731]

`logback-spring.xml` の中のプレースホルダは(`logback.xml` とは異なり) Logback でなく Spring が処理するので、 http://logback.qos.ch/manual/configuration.html#defaultValuesForVariables[Logback記法]ではなく https://docs.spring.io/spring-boot/docs/2.2.4.RELEASE/reference/html/howto.html#howto-use-short-command-line-arguments[Spring記法]を使うべし、ということのようです。

`:-` はLogbackのデフォルト値指定、 `:` はSpring記法でのデフォルト値指定ですね。